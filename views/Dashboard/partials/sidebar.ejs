<!-- Sidebar Overlay for Mobile -->
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<!-- Dashboard Sidebar -->
<aside class="dash-sidebar" id="dashSidebar">
  <!-- Mobile Close Button -->
  <button class="sidebar-close-btn" id="sidebarCloseBtn" aria-label="Close menu">
    <i data-lucide="x"></i>
  </button>

  <!-- Sidebar Header -->
  <div class="sidebar-header">
    <a href="/dashboard" class="sidebar-logo">
      <div class="sidebar-logo-icon">
        <i data-lucide="car"></i>
      </div>
      <span class="sidebar-logo-text">PartKon</span>
    </a>
  </div>

  <!-- Sidebar Navigation -->
  <nav class="sidebar-nav">
    <!-- Main Section -->
    <div class="sidebar-nav-section">
      <div class="sidebar-nav-title">Main</div>
      <a href="/dashboard" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'dashboard' ? 'active' : '' %>">
        <i data-lucide="layout-dashboard"></i>
        <span>Dashboard</span>
      </a>
      <a href="/dashboard/analytics" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'analytics' ? 'active' : '' %>">
        <i data-lucide="bar-chart-3"></i>
        <span>Analytics</span>
      </a>
    </div>

    <!-- Store Section -->
    <div class="sidebar-nav-section">
      <div class="sidebar-nav-title">Store</div>
      <a href="/dashboard/orders" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'orders' ? 'active' : '' %>">
        <i data-lucide="shopping-cart"></i>
        <span>Orders</span>
        <% if (typeof stats !== 'undefined' && stats.pendingOrders > 0) { %>
        <span class="sidebar-nav-badge warning"><%= stats.pendingOrders %></span>
        <% } %>
      </a>
      <a href="/dashboard/products" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'products' ? 'active' : '' %>">
        <i data-lucide="package"></i>
        <span>Products</span>
      </a>
      <a href="/dashboard/customers" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'customers' ? 'active' : '' %>">
        <i data-lucide="users"></i>
        <span>Customers</span>
      </a>
    </div>

    <!-- Website Section -->
    <div class="sidebar-nav-section">
      <div class="sidebar-nav-title">Website</div>
      <a href="/dashboard/appearance" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'appearance' ? 'active' : '' %>">
        <i data-lucide="palette"></i>
        <span>Appearance</span>
      </a>
      <a href="/dashboard/pages" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'pages' ? 'active' : '' %>">
        <i data-lucide="file-text"></i>
        <span>Pages</span>
      </a>
      <a href="/dashboard/domain" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'domain' ? 'active' : '' %>">
        <i data-lucide="globe"></i>
        <span>Domain</span>
      </a>
    </div>

    <!-- Settings Section -->
    <div class="sidebar-nav-section">
      <div class="sidebar-nav-title">Settings</div>
      <a href="/dashboard/settings" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'settings' ? 'active' : '' %>">
        <i data-lucide="settings"></i>
        <span>Settings</span>
      </a>
      <a href="/dashboard/billing" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'billing' ? 'active' : '' %>">
        <i data-lucide="credit-card"></i>
        <span>Billing</span>
      </a>
      <a href="/dashboard/support" class="sidebar-nav-item <%= typeof activePage !== 'undefined' && activePage === 'support' ? 'active' : '' %>">
        <i data-lucide="help-circle"></i>
        <span>Support</span>
      </a>
    </div>
  </nav>

  <!-- Sidebar Footer - User -->
  <div class="sidebar-footer">
    <div class="sidebar-user-wrapper" id="sidebarUserWrapper">
      <div class="sidebar-user" id="sidebarUserBtn">
        <div class="sidebar-user-avatar">
          <% if (typeof user !== 'undefined' && user.name) { %>
            <%= user.name.charAt(0).toUpperCase() %>
          <% } else { %>
            D
          <% } %>
        </div>
        <div class="sidebar-user-info">
          <div class="sidebar-user-name"><%= typeof user !== 'undefined' ? user.name : 'Demo User' %></div>
          <div class="sidebar-user-role"><%= typeof user !== 'undefined' ? user.plan : 'Pro Plan' %></div>
        </div>
        <i data-lucide="chevron-up" class="sidebar-user-chevron" style="width: 18px; height: 18px;"></i>
      </div>
      
      <!-- User Dropdown Menu -->
      <div class="sidebar-user-dropdown" id="sidebarUserDropdown">
        <a href="/dashboard/account" class="sidebar-user-menu-item">
          <i data-lucide="user"></i>
          <span>My Account</span>
        </a>
        <a href="/dashboard/settings" class="sidebar-user-menu-item">
          <i data-lucide="settings"></i>
          <span>Settings</span>
        </a>
        <div class="sidebar-user-menu-divider"></div>
        <a href="/logout" class="sidebar-user-menu-item danger">
          <i data-lucide="log-out"></i>
          <span>Sign Out</span>
        </a>
      </div>
    </div>
  </div>
</aside>

<script>
  // Sidebar user dropdown toggle
  document.addEventListener('DOMContentLoaded', function() {
    const userWrapper = document.getElementById('sidebarUserWrapper');
    const userBtn = document.getElementById('sidebarUserBtn');
    
    if (userBtn && userWrapper) {
      userBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        userWrapper.classList.toggle('active');
      });
      
      document.addEventListener('click', function() {
        userWrapper.classList.remove('active');
      });
    }
    
    // Mobile sidebar toggle
    const overlay = document.getElementById('sidebarOverlay');
    const sidebar = document.getElementById('dashSidebar');
    const closeBtn = document.getElementById('sidebarCloseBtn');
    const menuToggle = document.getElementById('mobileMenuToggle');
    
    if (menuToggle) {
      menuToggle.addEventListener('click', function() {
        sidebar.classList.add('active');
        overlay.classList.add('active');
      });
    }
    
    if (closeBtn) {
      closeBtn.addEventListener('click', function() {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      });
    }
    
    if (overlay) {
      overlay.addEventListener('click', function() {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      });
    }
  });
</script>
